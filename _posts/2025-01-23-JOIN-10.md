---
title: "상품 별 오프라인 매출 구하기"
description: >-
    JOIN
author: jutory
date: YYYY-MM-DD HH:MM:SS +09:00
categories: [SQL Coding Test, Programmers]
tags: [SQL]
---

## **문제**

다음은 어느 의류 쇼핑몰에서 판매 중인 상품들의 상품 정보를 담은 `PRODUCT` 테이블과 오프라인 상품 판매 정보를 담은 `OFFLINE_SALE` 테이블입니다.

> #### _PRODUCT 테이블_

| Column name   | Type         | Nullable | Description          |
|---------------|--------------|----------|----------------------|
| PRODUCT_ID    | INTEGER      | FALSE    | 상품 ID              |
| PRODUCT_CODE  | VARCHAR(8)   | FALSE    | 상품 코드            |
| PRICE         | INTEGER      | FALSE    | 판매가               |

상품별로 중복되지 않는 8자리 상품코드 값을 가지며, 앞 2자리는 카테고리 코드를 의미합니다.

> #### _OFFLINE_SALE 테이블_

| Column name       | Type         | Nullable | Description               |
|-------------------|--------------|----------|---------------------------|
| OFFLINE_SALE_ID   | INTEGER      | FALSE    | 오프라인 상품 판매 ID     |
| PRODUCT_ID        | INTEGER      | FALSE    | 상품 ID                  |
| SALES_AMOUNT      | INTEGER      | FALSE    | 판매량                   |
| SALES_DATE        | DATE         | FALSE    | 판매일                   |

동일한 날짜, 상품 ID 조합에 대해서는 하나의 판매 데이터만 존재합니다.

<br>
- - -
## **문제 정의**

> `PRODUCT` 테이블과 `OFFLINE_SALE` 테이블에서 아래 조건을 만족하는 데이터를 조회하는 SQL문을 작성하세요:
> 1. 상품코드(PRODUCT_CODE) 별 매출액(판매가 * 판매량) 합계를 계산
> 2. 결과는 매출액(SALES)을 기준으로 내림차순 정렬
> 3. 매출액이 같다면 상품코드(PRODUCT_CODE)를 기준으로 오름차순 정렬
> 
> 출력 컬럼:
> - 상품코드 (`PRODUCT_CODE`)
> - 매출액 (`SALES`)
> 
> 주의사항:  
> `SALES`는 정수로 출력  
{: .prompt-info }

<br>
- - -
## **정답**

```sql
SELECT 
    P.PRODUCT_CODE, 
    SUM(O.SALES_AMOUNT * P.PRICE) AS SALES
FROM 
    PRODUCT P
JOIN 
    OFFLINE_SALE O 
ON 
    P.PRODUCT_ID = O.PRODUCT_ID
GROUP BY 
    P.PRODUCT_CODE
ORDER BY 
    SALES DESC, 
    P.PRODUCT_CODE ASC;  
```

<br>
- - -
## **Tip**

> 1. **상품코드(PRODUCT_CODE) 별 매출액을 계산합니다.**  
>    - **`SUM(O.SALES_AMOUNT * P.PRICE)`**:  
>      - `SALES_AMOUNT`: 판매된 상품의 개수  
>      - `PRICE`: 상품의 판매가  
>      두 값을 곱하여 매출액을 계산한 후, 상품코드별로 합산합니다.  
>
> 2. **`GROUP BY`를 사용해 상품코드(PRODUCT_CODE) 기준으로 매출액을 그룹화합니다.**
>
> 3. **결과를 정렬합니다.**  
>    - **`ORDER BY SALES DESC`**: 매출액을 기준으로 내림차순 정렬  
>    - **`ORDER BY PRODUCT_CODE ASC`**: 매출액이 같은 경우 상품코드를 기준으로 오름차순 정렬  
>
> 4. **쿼리 작성의 주요 포인트:**  
>    - 두 테이블(`PRODUCT`, `OFFLINE_SALE`)을 `JOIN`하여 상품 ID(`PRODUCT_ID`)를 기준으로 매칭합니다.  
>    - `GROUP BY`와 `SUM`을 활용해 매출액을 집계합니다.  
{: .prompt-tip }
> SQL Dialect Used: Oracle

<br>
- - -
## **Useful link**

[상품 별 오프라인 매출 구하기](https://school.programmers.co.kr/learn/courses/30/lessons/131533)