---
title: "특정 기간동안 대여 가능한 자동차들의 대여비용 구하기"
description: >-
    JOIN
author: jutory
date: YYYY-MM-DD HH:MM:SS +09:00
categories: [SQL Coding Test, Programmers]
tags: [SQL]
---

## **문제**

다음은 식품의 정보를 담은 `FOOD_PRODUCT` 테이블과 식품의 주문 정보를 담은 `FOOD_ORDER` 테이블입니다.

> #### _FOOD_PRODUCT 테이블_

| Column name  | Type         | Nullable | Description          |
|--------------|--------------|----------|----------------------|
| PRODUCT_ID   | VARCHAR(10)  | FALSE    | 식품 ID              |
| PRODUCT_NAME | VARCHAR(50)  | FALSE    | 식품 이름            |
| PRODUCT_CD   | VARCHAR(10)  | TRUE     | 식품 코드            |
| CATEGORY     | VARCHAR(10)  | TRUE     | 식품 분류            |
| PRICE        | NUMBER       | TRUE     | 식품 가격            |

> #### _FOOD_ORDER 테이블_

| Column name  | Type         | Nullable | Description          |
|--------------|--------------|----------|----------------------|
| ORDER_ID     | VARCHAR(10)  | FALSE    | 주문 ID              |
| PRODUCT_ID   | VARCHAR(5)   | FALSE    | 제품 ID              |
| AMOUNT       | NUMBER       | FALSE    | 주문량               |
| PRODUCE_DATE | DATE         | TRUE     | 생산 일자            |
| IN_DATE      | DATE         | TRUE     | 입고 일자            |
| OUT_DATE     | DATE         | TRUE     | 출고 일자            |
| FACTORY_ID   | VARCHAR(10)  | FALSE    | 공장 ID              |
| WAREHOUSE_ID | VARCHAR(10)  | FALSE    | 창고 ID              |

<br>
- - -
## **문제 정의**

> `CAR_RENTAL_COMPANY_CAR` 테이블, `CAR_RENTAL_COMPANY_RENTAL_HISTORY` 테이블, `CAR_RENTAL_COMPANY_DISCOUNT_PLAN` 테이블에서 아래 조건을 만족하는 자동차 리스트를 출력하는 SQL문을 작성하세요:
> 1. 자동차 종류가 `세단` 또는 `SUV`인 자동차 중
> 2. **2022년 11월 1일부터 2022년 11월 30일까지 대여 가능**하고
> 3. 30일간의 대여 금액이 **50만 원 이상, 200만 원 미만**인 자동차
> 
> 출력 컬럼:
> - 자동차 ID (`CAR_ID`)
> - 자동차 종류 (`CAR_TYPE`)
> - 대여 금액 (`FEE`)
> 
> 결과 정렬 기준:
> 1. 대여 금액을 기준으로 내림차순 정렬
> 2. 대여 금액이 같을 경우 자동차 종류를 기준으로 오름차순 정렬
> 3. 자동차 종류까지 같을 경우 자동차 ID를 기준으로 내림차순 정렬
> 
> 주의사항:  
> `FEE`는 정수로 출력  
{: .prompt-info }

<br>
- - -
## **정답**

```sql
SELECT 
    FP.PRODUCT_ID, 
    FP.PRODUCT_NAME, 
    SUM(FO.AMOUNT * FP.PRICE) AS TOTAL_SALES
FROM 
    FOOD_PRODUCT FP
JOIN 
    FOOD_ORDER FO 
ON 
    FP.PRODUCT_ID = FO.PRODUCT_ID
WHERE 
    TO_CHAR(FO.PRODUCE_DATE, 'YYYY-MM') = '2022-05'
GROUP BY 
    FP.PRODUCT_ID, FP.PRODUCT_NAME
ORDER BY 
    TOTAL_SALES DESC, 
    FP.PRODUCT_ID ASC;
```

<br>
- - -
## **Tip**

> 1. **생산일자가 2022년 5월인 제품을 필터링합니다.**  
>    - **`TO_CHAR(PRODUCE_DATE, 'YYYY-MM') = '2022-05'`**: `PRODUCE_DATE`를 연도와 월로 변환하여 2022년 5월을 선택합니다.
>
> 2. **총매출을 계산합니다.**  
>    - **`SUM(AMOUNT * PRICE)`**: 주문량(`AMOUNT`)과 가격(`PRICE`)을 곱하여 총매출을 계산합니다.
{: .prompt-tip }
> SQL Dialect Used: Oracle

<br>
- - -
## **Useful link**

[5월 식품들의 총매출 조회하기](https://school.programmers.co.kr/learn/courses/30/lessons/131117)