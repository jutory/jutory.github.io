---
title: "분기별 분화된 대장균 개체 수 구하기"
description: >-
  STRING, DATE
author: jutory
date: 2025-02-03
categories: [SQL Coding Test, Programmers]
tags: [SQL]
---

<br>
## **문제 설명**

대장균들은 일정 주기로 분화하며, 분화를 시작한 개체를 부모 개체, 분화되어 나온 개체를 자식 개체라고 합니다.  
실험실에서 배양한 대장균들의 정보를 담은 **ECOLI_DATA** 테이블은 다음과 같은 구조를 가지고 있습니다.

| Column name           | Type    | Nullable | Description             |
|-----------------------|---------|----------|-------------------------|
| ID                    | INTEGER | FALSE    | 대장균 개체의 ID         |
| PARENT_ID             | INTEGER | TRUE     | 부모 개체의 ID           |
| SIZE_OF_COLONY        | INTEGER | FALSE    | 개체의 크기             |
| DIFFERENTIATION_DATE  | DATE    | FALSE    | 분화되어 나온 날짜       |
| GENOTYPE              | INTEGER | FALSE    | 개체의 형질            |

최초의 대장균 개체의 PARENT_ID는 NULL 값입니다.

<br>
- - -
<br>
## **문제**

> 각 분기(QUARTER)별 분화된 대장균의 개체의 총 수(ECOLI_COUNT)를 출력하는 SQL 문을 작성해주세요. 이때 각 분기에는 'Q' 를 붙이고 분기에 대해 오름차순으로 정렬해주세요. 대장균 개체가 분화되지 않은 분기는 없습니다.

> 예를 들어, **ECOLI_DATA** 테이블이 아래와 같다면

| ID | PARENT_ID | SIZE_OF_COLONY | DIFFERENTIATION_DATE | GENOTYPE |
|----|-----------|----------------|----------------------|----------|
| 1  | NULL      | 10             | 2019/01/01           | 5        |
| 2  | NULL      | 2              | 2019/05/01           | 3        |
| 3  | 1         | 100            | 2020/01/01           | 4        |
| 4  | 2         | 17             | 2022/04/01           | 4        |
| 5  | 2         | 10             | 2020/09/01           | 6        |
| 6  | 4         | 101            | 2021/12/01           | 22       |

> 각 분기별로 분화된 대장균 개체는 다음과 같이 나뉩니다.

- **1분기** : ID 1, ID 3  
- **2분기** : ID 2, ID 4  
- **3분기** : ID 5  
- **4분기** : ID 6  

> 따라서 결과는 다음과 같아야 합니다.

| QUARTER | ECOLI_COUNT |
|---------|-------------|
| 1Q      | 2           |
| 2Q      | 2           |
| 3Q      | 1           |
| 4Q      | 1           |
{: .prompt-info }

<br>
- - -
<br>
<details>
  <summary style="font-size: 1.5em; font-weight: bold;">풀이 과정</summary>
<div markdown="1">

1. **분기 추출**  
   - MySQL의 `QUARTER(DIFFERENTIATION_DATE)` 함수를 사용하여 각 대장균 개체의 분화 날짜에서 해당 분기를 숫자(1~4)로 추출합니다.

2. **형식 지정**  
   - `CONCAT(QUARTER(DIFFERENTIATION_DATE), 'Q')` 함수를 사용하여 추출한 분기 숫자 뒤에 문자 `'Q'`를 붙여 `1Q, 2Q, 3Q, 4Q`와 같은 형식으로 결과를 표시합니다.

3. **집계**  
   - `COUNT(*)` 함수를 이용해 각 분기에 분화된 대장균 개체의 총 개수를 계산합니다.

4. **그룹화 및 정렬**  
   - `GROUP BY` 절에 `CONCAT(QUARTER(DIFFERENTIATION_DATE), 'Q')` 표현식을 사용하여 동일한 분기의 데이터를 그룹화합니다.
   - `ORDER BY` 절을 사용해 그룹화된 결과를 분기 순서대로 오름차순 정렬합니다.
</div>
</details>

<br>
- - -
<br>
## **정답**

```sql
SELECT 
    CONCAT(QUARTER(DIFFERENTIATION_DATE), 'Q') AS QUARTER,
    COUNT(*) AS ECOLI_COUNT
FROM 
    ECOLI_DATA
GROUP BY 
    CONCAT(QUARTER(DIFFERENTIATION_DATE), 'Q')
ORDER BY 
    QUARTER;
```

- - -
<br>
## **Tip**

> 1. **분기 추출하고 변환하기**
>    - `QUARTER(DIFFERENTIATION_DATE)` 함수 사용하여 날짜에서 분기 정보 추출
>    - `CONCAT()` 함수를 사용하여 분기 번호 뒤에 `Q`를 붙여 결과를 원하는 형식(`1Q, 2Q, ...`)으로 변환
>
> 2. **그룹화와 정렬**
>    - 동일한 표현식을 **GROUP BY절**에 사용하여 각 분기에 해당하는 대장균 개체 수를 집계
{: .prompt-tip }
> SQL Dialect Used: MySQL

- - -
<br>
## **개념 확인**

> - **QUARTER 함수**
>   - QUARTER(`DATE형식컬럼값`)은 주어진 날짜에서 분기를 숫자(1~4)로 반환

> - **CONCAT 함수**
>   - 여러 문자열을 하나로 연결합니다. 여기서는 분기 숫자와 'Q'를 결합

<br>
- - -
<br>
## **Useful link**

[분기별 분화된 대장균 개체 수 구하기](https://school.programmers.co.kr/learn/courses/30/lessons/299308)