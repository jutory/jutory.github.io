---
title: "그룹별 조건에 맞는 식당 목록 출력하기"
description: >-
    JOIN
author: jutory
date: YYYY-MM-DD HH:MM:SS +09:00
categories: [SQL Coding Test, Programmers]
tags: [SQL]
---

## **문제**

다음은 고객의 정보를 담은 `MEMBER_PROFILE` 테이블과 식당의 리뷰 정보를 담은 `REST_REVIEW` 테이블입니다.

> #### _MEMBER_PROFILE 테이블_

| Column name   | Type         | Nullable | Description          |
|---------------|--------------|----------|----------------------|
| MEMBER_ID     | VARCHAR(100) | FALSE    | 회원 ID              |
| MEMBER_NAME   | VARCHAR(50)  | FALSE    | 회원 이름            |
| TLNO          | VARCHAR(50)  | TRUE     | 회원 연락처          |
| GENDER        | VARCHAR(1)   | TRUE     | 성별                 |
| DATE_OF_BIRTH | DATE         | TRUE     | 생년월일            |

> #### _REST_REVIEW 테이블_

| Column name   | Type         | Nullable | Description          |
|---------------|--------------|----------|----------------------|
| REVIEW_ID     | VARCHAR(10)  | FALSE    | 리뷰 ID              |
| REST_ID       | VARCHAR(10)  | TRUE     | 식당 ID              |
| MEMBER_ID     | VARCHAR(100) | TRUE     | 회원 ID              |
| REVIEW_SCORE  | NUMBER       | TRUE     | 리뷰 점수            |
| REVIEW_TEXT   | VARCHAR(1000)| TRUE     | 리뷰 텍스트          |
| REVIEW_DATE   | DATE         | TRUE     | 리뷰 작성일          |

<br>
- - -
## **문제 정의**

> `MEMBER_PROFILE`와 `REST_REVIEW` 테이블에서 아래 조건을 만족하는 데이터를 조회하는 SQL문을 작성하세요:
> 1. 리뷰를 가장 많이 작성한 회원의 모든 리뷰를 조회합니다.
> 2. 회원 이름(`MEMBER_NAME`), 리뷰 텍스트(`REVIEW_TEXT`), 리뷰 작성일(`REVIEW_DATE`)을 출력합니다.
>
> 출력 컬럼:
> - 회원 이름 (`MEMBER_NAME`)
> - 리뷰 텍스트 (`REVIEW_TEXT`)
> - 리뷰 작성일 (`REVIEW_DATE`)
>
> 결과 정렬 기준:
> 1. 리뷰 작성일을 기준으로 **오름차순 정렬**
> 2. 리뷰 작성일이 같다면 리뷰 텍스트를 기준으로 **오름차순 정렬**
>
> 주의사항:  
> 동일한 회원 ID를 가진 회원 중 가장 많은 리뷰를 작성한 회원의 리뷰만 출력합니다.  
{: .prompt-info }

<br>
- - -
## **정답**

```sql
SELECT
    MP.MEMBER_NAME,
    RR.REVIEW_TEXT,
    TO_CHAR(RR.REVIEW_DATE, 'YYYY-MM-DD') AS REVIEW_DATE
FROM
    MEMBER_PROFILE MP
JOIN
    REST_REVIEW RR
ON
    MP.MEMBER_ID = RR.MEMBER_ID
WHERE
    RR.MEMBER_ID = (
        SELECT MEMBER_ID
        FROM REST_REVIEW
        GROUP BY MEMBER_ID
        ORDER BY COUNT(*) DESC
        FETCH FIRST 1 ROWS ONLY
    )
ORDER BY
    RR.REVIEW_DATE ASC,
    RR.REVIEW_TEXT ASC;  
```

<br>
- - -
## **Tip**

> 1. **리뷰를 가장 많이 작성한 회원을 식별합니다.**  
>    - **`WITH REVIEW_COUNT`**: 각 회원별 리뷰 개수를 계산합니다.  
>    - **`WITH MAX_REVIEWER`**: 리뷰 개수가 가장 많은 회원의 `MEMBER_ID`를 식별합니다.  
>    - **`MAX(REVIEW_COUNT)`**를 사용하여 가장 많은 리뷰를 작성한 회원을 선택합니다.  
>
> 2. **해당 회원의 리뷰를 조회합니다.**  
>    - `MEMBER_PROFILE`와 `REST_REVIEW`를 **`MEMBER_ID`**를 기준으로 JOIN하여 회원 이름과 리뷰 정보를 가져옵니다.
>
> 3. **정렬 조건을 적용합니다.**  
>    - **`ORDER BY REVIEW_DATE ASC`**: 리뷰 작성일 기준으로 오름차순 정렬  
>    - **`ORDER BY REVIEW_TEXT ASC`**: 리뷰 작성일이 같을 경우 리뷰 텍스트 기준으로 오름차순 정렬  
>
{: .prompt-tip }
> SQL Dialect Used: Oracle

<br>
- - -
## **Useful link**

[그룹별 조건에 맞는 식당 목록 출력하기](https://school.programmers.co.kr/learn/courses/30/lessons/131124)