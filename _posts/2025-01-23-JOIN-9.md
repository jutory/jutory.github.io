---
title: "보호소에서 중성화한 동물"
description: >-
    JOIN
author: jutory
date: YYYY-MM-DD HH:MM:SS +09:00
categories: [SQL Coding Test, Programmers]
tags: [SQL]
---

## **문제**

다음은 동물 보호소에 들어온 동물과 입양된 동물의 정보를 담은 `ANIMAL_INS` 테이블과 `ANIMAL_OUTS` 테이블입니다.

> #### _ANIMAL_INS 테이블_

| Column name     | Type        | Nullable | Description             |
|------------------|-------------|----------|-------------------------|
| ANIMAL_ID        | VARCHAR(N)  | FALSE    | 동물 ID                 |
| ANIMAL_TYPE      | VARCHAR(N)  | FALSE    | 생물 종                 |
| DATETIME         | DATETIME    | FALSE    | 보호 시작일             |
| INTAKE_CONDITION | VARCHAR(N)  | FALSE    | 보호 시작 시 상태       |
| NAME             | VARCHAR(N)  | TRUE     | 이름                    |
| SEX_UPON_INTAKE  | VARCHAR(N)  | FALSE    | 성별 및 중성화 여부     |

> #### _ANIMAL_OUTS 테이블_

| Column name       | Type        | Nullable | Description             |
|--------------------|-------------|----------|-------------------------|
| ANIMAL_ID          | VARCHAR(N)  | FALSE    | 동물 ID                 |
| ANIMAL_TYPE        | VARCHAR(N)  | FALSE    | 생물 종                 |
| DATETIME           | DATETIME    | FALSE    | 입양일                  |
| NAME               | VARCHAR(N)  | TRUE     | 이름                    |
| SEX_UPON_OUTCOME   | VARCHAR(N)  | FALSE    | 성별 및 중성화 여부     |

<br>
- - -
## **문제 정의**

> `ANIMAL_INS`와 `ANIMAL_OUTS` 테이블에서 아래 조건을 만족하는 동물 정보를 조회하는 SQL문을 작성하세요:
> 1. 보호소에 들어올 당시에는 중성화되지 않았지만, 보호소를 나갈 당시에는 중성화된 동물
> 2. 출력 컬럼:
>    - 동물 ID (`ANIMAL_ID`)
>    - 생물 종 (`ANIMAL_TYPE`)
>    - 이름 (`NAME`)
> 3. 결과는 동물 ID를 기준으로 오름차순 정렬
> 
> 주의사항:  
> - 중성화 상태는 다음과 같이 구분합니다:
>   - 중성화되지 않음: `Intact Male`, `Intact Female`
>   - 중성화됨: `Neutered Male`, `Spayed Female`  
{: .prompt-info }

<br>
- - -
## **정답**

```sql
SELECT 
    AI.ANIMAL_ID,
    AI.ANIMAL_TYPE,
    AI.NAME
FROM 
    ANIMAL_INS AI
JOIN 
    ANIMAL_OUTS AO 
ON 
    AI.ANIMAL_ID = AO.ANIMAL_ID
WHERE 
    (AI.SEX_UPON_INTAKE LIKE 'Intact%')
    AND 
    (AO.SEX_UPON_OUTCOME LIKE 'Neutered%' OR AO.SEX_UPON_OUTCOME LIKE 'Spayed%')
ORDER BY 
    AI.ANIMAL_ID ASC;  
```

<br>
- - -
## **Tip**

> 1. **보호소에 들어올 당시 중성화되지 않은 동물을 필터링합니다.**  
>    - **`SEX_UPON_INTAKE LIKE 'Intact%'`**: 중성화되지 않은 상태(`Intact Male`, `Intact Female`)를 가진 동물을 선택합니다.
>
> 2. **보호소를 나갈 당시 중성화된 동물을 필터링합니다.**  
>    - **`SEX_UPON_OUTCOME LIKE 'Neutered%'`**: 중성화된 수컷(`Neutered Male`)을 필터링합니다.  
>    - **`SEX_UPON_OUTCOME LIKE 'Spayed%'`**: 중성화된 암컷(`Spayed Female`)을 필터링합니다.
>
> 3. **`JOIN`을 통해 두 테이블을 연결합니다.**  
>    - **`ANIMAL_INS.ANIMAL_ID = ANIMAL_OUTS.ANIMAL_ID`**: 두 테이블의 동물 ID를 기준으로 매칭하여 입소 당시와 퇴소 당시의 정보를 결합합니다.
>
> 4. **결과를 정렬합니다.**  
>    - **`ORDER BY AI.ANIMAL_ID ASC`**: 동물 ID를 기준으로 오름차순 정렬하여 결과를 출력합니다.
>
> 5. **필터링 논리**:  
>    - 보호소에 들어올 당시에는 **`Intact` 상태**로 중성화되지 않았지만, 보호소를 나갈 당시에는 **`Neutered`** 또는 **`Spayed`** 상태로 변경된 동물을 찾습니다.
{: .prompt-tip }
> SQL Dialect Used: Oracle

<br>
- - -
## **Useful link**

[보호소에서 중성화한 동물](https://school.programmers.co.kr/learn/courses/30/lessons/59045)