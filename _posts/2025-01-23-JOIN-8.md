---
title: "오랜 기간 보호한 동물(1)"
description: >-
    JOIN
author: jutory
date: YYYY-MM-DD HH:MM:SS +09:00
categories: [SQL Coding Test, Programmers]
tags: [SQL]
---

## **문제**

다음은 동물 보호소의 동물 정보를 담은 `ANIMAL_INS` 테이블과 입양 정보를 담은 `ANIMAL_OUTS` 테이블입니다.

> #### _ANIMAL_INS 테이블_

| Column name      | Type         | Nullable | Description                 |
|------------------|--------------|----------|-----------------------------|
| ANIMAL_ID        | VARCHAR(N)   | FALSE    | 동물 ID                     |
| ANIMAL_TYPE      | VARCHAR(N)   | FALSE    | 생물 종                     |
| DATETIME         | DATETIME     | FALSE    | 보호 시작일                 |
| INTAKE_CONDITION | VARCHAR(N)   | FALSE    | 보호 시작 시 상태           |
| NAME             | VARCHAR(N)   | TRUE     | 이름                        |
| SEX_UPON_INTAKE  | VARCHAR(N)   | FALSE    | 성별 및 중성화 여부         |

> #### _ANIMAL_OUTS 테이블_

| Column name         | Type         | Nullable | Description                 |
|---------------------|--------------|----------|-----------------------------|
| ANIMAL_ID           | VARCHAR(N)   | FALSE    | 동물 ID                     |
| ANIMAL_TYPE         | VARCHAR(N)   | FALSE    | 생물 종                     |
| DATETIME            | DATETIME     | FALSE    | 입양일                      |
| NAME                | VARCHAR(N)   | TRUE     | 이름                        |
| SEX_UPON_OUTCOME    | VARCHAR(N)   | FALSE    | 성별 및 중성화 여부         |

<br>
- - -
## **문제 정의**

> `ANIMAL_INS` 테이블과 `ANIMAL_OUTS` 테이블에서 아래 조건을 만족하는 데이터를 조회하는 SQL문을 작성하세요:
> 1. **입양되지 못한 동물**만 조회합니다.
> 2. 보호소에 가장 오래 있었던 동물 **3마리의 이름과 보호 시작일**을 조회합니다.
> 3. 결과는 **보호 시작일(DATETIME) 순으로 정렬**합니다.

> 출력 컬럼:
> - 동물 이름 (`NAME`)
> - 보호 시작일 (`DATETIME`)

> 주의사항:  
> `입양을 가지 못한 동물 3마리 이상인 경우만 입력으로 주어집니다.`  
{: .prompt-info }

<br>
- - -
## **정답**

```sql
SELECT 
    AI.NAME, 
    AI.DATETIME
FROM 
    ANIMAL_INS AI
LEFT JOIN 
    ANIMAL_OUTS AO
ON 
    AI.ANIMAL_ID = AO.ANIMAL_ID
WHERE 
    AO.ANIMAL_ID IS NULL
ORDER BY 
    AI.DATETIME ASC
FETCH FIRST 3 ROWS ONLY;
```

<br>
- - -
## **Tip**

> 1. **입양되지 못한 동물을 조회합니다.**  
>    - **`LEFT JOIN`**: `ANIMAL_INS`와 `ANIMAL_OUTS`를 조인합니다.  
>    - **`WHERE AO.ANIMAL_ID IS NULL`**: `ANIMAL_OUTS` 테이블에 없는 동물(`ANIMAL_ID`)만 선택하여 입양되지 못한 동물을 필터링합니다.  
>
> 2. **보호 시작일 순으로 정렬합니다.**  
>    - **`ORDER BY AI.DATETIME ASC`**: 보호 시작일(`DATETIME`)을 기준으로 오름차순 정렬하여 보호소에 가장 오래 머문 동물부터 나열합니다.  
>
> 3. **상위 3마리로 제한합니다.**  
>    - **`FETCH FIRST 3 ROWS ONLY`**: 보호소에 가장 오래 있었던 동물 중 상위 3마리만 결과로 반환합니다. (MYSQL로는 LIMIT 3;)
>
> 4. **`NULL` 처리 주의**  
>    - 동물의 이름(`NAME`)은 NULL이 될 수 있으므로, 결과에서 적절히 고려합니다.  
{: .prompt-tip }
> SQL Dialect Used: Oracle

<br>
- - -
## **Useful link**

[오랜 기간 보호한 동물(1)](https://school.programmers.co.kr/learn/courses/30/lessons/59044)